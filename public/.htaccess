<IfModule mod_rewrite.c>
  # Enable rewrite engine
  RewriteEngine On
  
  # Set base directory (change if your site is in a subfolder)
  RewriteBase /
  
  # Force HTTPS (optional but recommended)
  # RewriteCond %{HTTPS} off
  # RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
  
  # Ensure correct MIME types for JavaScript modules
  <IfModule mod_mime.c>
    AddType application/javascript .js
    AddType application/javascript .mjs
    AddType text/css .css
    AddType image/svg+xml .svg
    AddType image/webp .webp
  </IfModule>
  
  # Don't rewrite files or directories that exist
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # Don't rewrite asset files
  RewriteCond %{REQUEST_URI} !^/assets/
  RewriteCond %{REQUEST_URI} !^/data/
  RewriteCond %{REQUEST_URI} !\.(?:css|js|json|xml|txt|webp|jpg|jpeg|png|gif|svg|ico|woff|woff2|ttf|eot)$
  
  # Rewrite all other requests to index.html for React Router
  RewriteRule ^ index.html [L]
  
  # Disable directory listing
  Options -Indexes
  
  # Enable CORS for fonts (if needed)
  <IfModule mod_headers.c>
    <FilesMatch "\.(ttf|ttc|otf|eot|woff|woff2)$">
      Header set Access-Control-Allow-Origin "*"
    </FilesMatch>
  </IfModule>
  
  # Cache static assets
  <IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/json "access plus 1 week"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType image/x-icon "access plus 1 year"
  </IfModule>
  
  # Compress text files
  <IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/json
  </IfModule>
</IfModule>

# Fallback for servers without mod_rewrite
<IfModule !mod_rewrite.c>
  ErrorDocument 404 /index.html
</IfModule>
